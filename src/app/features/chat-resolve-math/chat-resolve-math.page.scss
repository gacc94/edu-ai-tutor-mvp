@use "mixins";

.chat-resolve-math {
    &__header {
        &-toolbar {
            --color: var(--color-text);
            --border-width: 0; // Remove bottom border if any
        }

        .chat-resolve-math__title {
            font-size: var(--h2-font-size);
            font-weight: var(--font-medium);
            text-align: center; // As per image
        }

        .chat-resolve-math__back-button {
            --color: var(--color-text);
        }
    }

    &__content {
        --background: var(--color-bg-main);
        --padding-start: var(--spacing-md);
        --padding-end: var(--spacing-md);
        --padding-top: var(--spacing-md);
        --padding-bottom: var(--spacing-md); // Space for footer
    }

    &__message-list {
        background: transparent;
        padding: 0;
    }

    &__message-item {
        --background: transparent;
        --padding-start: 0;
        --padding-end: 0;
        --inner-padding-end: 0; // Remove default ion-item padding
        --min-height: auto;
        margin-bottom: var(--spacing-md); // Increased spacing between messages
        display: flex; // Enables flex alignment for bubble
        width: 100%;

        &--user {
            justify-content: flex-end;
            .chat-resolve-math__bubble {
                margin-left: auto; // Pushes bubble to the right
            }
        }

        &--ai {
            justify-content: flex-start;
            .chat-resolve-math__avatar {
                margin-right: var(--spacing-sm);
            }
        }
    }

    &__avatar {
        width: 36px; // Slightly smaller avatar
        height: 36px;
        background-color: var(--color-bg-light); // Darker avatar bg
        border-radius: var(--border-radius-circle);
        @include mixins.flex-center;
        align-self: flex-end; // Align avatar to bottom of message bubble
        margin-bottom: var(--spacing-xs); // Align with bubble bottom padding

        &-icon {
            font-size: var(--size-md-xl); // Slightly smaller icon
            color: var(--color-text-secondary);
        }
    }

    &__bubble {
        padding: var(--spacing-sm) var(--size-sm); // Adjusted padding
        border-radius: var(--border-radius);
        max-width: 80%; // Allow slightly wider bubbles
        word-wrap: break-word; // Ensure long words break

        &-text {
            margin: 0;
            font-size: var(--normal-font-size);
            line-height: 1.5;
            white-space: pre-wrap; // Preserve line breaks in messages
        }

        &--user {
            background-color: var(--color-primary);
            color: var(--color-white);
            border-top-right-radius: var(--border-radius-sm); // As per image
            border-bottom-right-radius: var(--border-radius);
            border-top-left-radius: var(--border-radius);
            border-bottom-left-radius: var(--border-radius);
        }

        &--ai {
            background-color: var(--color-bg-card); // Darker AI bubble
            color: var(--color-text);
            border-top-left-radius: var(--border-radius-sm); // As per image
            border-bottom-left-radius: var(--border-radius);
            border-top-right-radius: var(--border-radius);
            border-bottom-right-radius: var(--border-radius);
        }
    }

    &__footer {
        &-toolbar {
            --min-height: auto;
            --padding-start: var(--spacing-sm); // Reduced padding
            --padding-end: var(--spacing-sm);
            --padding-top: var(--spacing-xs);
            --padding-bottom: var(--spacing-xs);
        }
    }

    &__input {
        padding: var(--spacing-sm);
        --highlight-color-focused: var(--color-primary);
        --highlight-height: 0;
        &-wrapper {
            border-radius: var(--button-radius);
            background-color: var(--color-bg-card); // Using --color-bg-card for the darker purple/blue tint from image
            padding-inline: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }
    }

    // &__input {
    //     --padding-start: var(--spacing-sm);
    //     --padding-end: var(--spacing-sm);
    //     --padding-top: var(--spacing-sm); // Ensure text is vertically centered
    //     --padding-bottom: var(--spacing-sm);
    //     --placeholder-color: var(--color-text-muted);
    //     --placeholder-opacity: 1;
    //     --color: var(--color-text);
    //     font-size: var(--normal-font-size);
    //     border: none;
    // }

    &__attach-button {
        --color: var(--color-text-secondary);
        font-size: var(--size-lg);
        margin: 0 var(--spacing-xs);
    }

    &__send-button {
        --background: var(--color-primary);
        --color: var(--color-white);
        --border-radius: var(--border-radius-circle);
        --box-shadow: none; // Remove default shadow if any
        --padding-start: 0; // Ensure icon is centered
        --padding-end: 0;
        width: 44px; // Fixed size for circular button
        height: 44px;
        display: flex;
        justify-content: center;
        align-items: center;

        ion-icon {
            font-size: var(--size-lg); // Send icon size
        }

        &[disabled] {
            --background: var(--color-bg-light); // Disabled state
            --color: var(--color-text-muted);
        }
    }
}

.chat-wrapper {
    display: grid;
    grid-template-columns: auto 1fr auto;
    gap: var(--spacing-sm);
    align-items: center;
}
